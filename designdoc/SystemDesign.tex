%==============================================================================
\documentclass[11pt,oneside,onecolumn,letterpaper]{article}
\usepackage{times}
\usepackage[paperwidth=8.5in, paperheight=11in,
top=2.5cm, bottom=2.6cm, left=2.58cm, right=2.53cm]{geometry}
%\setlength{\textheight} {9.00in}
%\setlength{\textwidth}  {6.40in}
%\setlength{\topmargin}  {-0.50in}
%%\setlength{\headheight} {0.00in}
%%\setlength{\headsep}     {0.40in}
%\setlength{\oddsidemargin}{-0.010in}
%\setlength{\evensidemargin}{-0.00in}
%==============================================================================
%\usepackage{algorithm}
\usepackage{amssymb}
\usepackage{color}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{latexsym}
\usepackage{subfigure}
\usepackage{wrapfig}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage[hyphens]{url}
\usepackage{pifont}
\usepackage{color}
\usepackage{colortbl}
\usepackage[lined, boxed, linesnumbered]{algorithm2e}
\usepackage[square, comma, sort&compress, numbers]{natbib}

\newcounter{alg}
\newenvironment{enum-ref}{
\begin{list}%
{[\arabic{alg}]} {\usecounter{alg}
  \setlength{\leftmargin} {0.25in}
  \setlength{\labelwidth} {0.30in}
  \setlength{\rightmargin}{0.00in}
  \setlength{\topsep}     {0.00in}}
}{\end{list}}

\newenvironment{enum-number}{
\begin{list}%
{\arabic{alg})} {\usecounter{alg}
  \setlength{\leftmargin} {0.25in}
  \setlength{\labelwidth} {0.30in}
  \setlength{\rightmargin}{0.00in}
  \setlength{\topsep}     {0.00in}}
}{\end{list}}

\newenvironment{enum-nonum}{
\begin{list}%
{$\bullet$} {
  \setlength{\leftmargin} {0.25in}
  \setlength{\labelwidth} {0.30in}
  \setlength{\rightmargin}{0.00in}
  \setlength{\topsep}     {0.00in}}
}{\end{list}}

\let\chapter\section

%==============================================================================
\pagestyle{plain}
%==============================================================================

\title{Secure Avionics Flight Firmware Installation Routine System Design}
\author{MITRE eCTF 2022\\Team \textbf{Cacti}\\ University at Buffalo}
\date{}



\begin{document}
%%
%=============================================================================
\normalsize


\maketitle
%\date{}

\renewcommand{\thepage}{System Design, Team Cacti, University at Buffalo--\arabic{page}}
\setcounter{page}{1} \normalsize
%
%\renewcommand{\baselinestretch}{1.2}
%\normalsize
%\vspace{0.1in}
%\centerline{\textbf{\Large }}
%\renewcommand{\baselinestretch}{1.0}
%\normalsize

\newcommand{\flagRollback}{\textsf{Rollback}\xspace}

\section{Introduction}

This section presents the entities and communication channels in the system.

\subsection{Entities}

The following summarizes the entities in the system.

\begin{itemize}
	\item A SAFFIRE bootloader is the main entity of the system to ensure the secure loading of flight configuration data and firmware with version updates on the device.
	When the SAFFIRE bootloader receives commands to boot the firmware, it is responsible for putting firmware on SRAM and handover the execution to the firmware. 
	Moreover, the bootloader is also responsible for providing a readback feature of the firmware and configuration data to an authenticated host.
	
	\item Host is a general-purpose computer in the secure facility, which is responsible for generating protected firmware and configuration data images.
	\item  EEPROM on the Tivaware device is a hardware component accessible to the bootloader, which can be used to store data with access permissions.
	\item The firmware in the avionic device contains the logic to control the flight during flight. 
	The firmware gets the flight itinerary from the configuration files.
	As the flight travel is dependent on this logic and data the bootloader needs to ensure that no malicious code or data is loaded on the device.
\end{itemize}



\section{Attack Models}

The attackers can carry out the following attacks:

\begin{itemize}
  \item Read from the FLASH.
  \item Side-channel attack.
  \item Hardware trojan.
\end{itemize}


\section{Our Design}

Each host $H$ has its private key $sk_k$ stored in the host secrets file.
The bootloader can access a list of valid hosts with the associated public key $pk_k$ and two AES256-GCM keys for firmware ($k_f$) and configuration ($k_c$) protection, which are stored in the EEPROM.
EEPROM also stores additional data or secrets that the bootloader needs at run-time.
MPU is configured to 1) prevent the EEPROM from being accessed by an invalid host; 2) set the FLASH as read-only except for the bootloader.

ENC and DEC stand for symmetric encryption and decryption with AES256-GCM.
AENC and ADEC stand for asymmetric encryption and decryption with RSA512.
SIG and AUTH stand for the signature and verification with RSA512.

\subsection{Key Generation and Storage}

\subsection{Firmware and Configuration Data Protection}

\subsection{Readback Host Authentication}

\subsection{Prevent Version Rollback}
  
\subsection{Defeat Hardware Trojan}

\subsection{Defeat Side-channel Attacks}

\subsection{Build Process}

  Describe the important changes in build process.

\section{Implementation}
\subsection{Critical Functions and Files}


% \section{Flag Protection}

% \subsection{\textsf{D}}


\end{document}
%==============================================================================
